Resolving data files: 100%|████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 33198.87it/s]
Downloading data: 100%|█████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 37936.39files/s]
Generating train split: 3676 examples [17:55,  3.42 examples/s]
Traceback (most recent call last):
  File "/home/gilyoav/miniconda3/lib/python3.12/site-packages/datasets/builder.py", line 2011, in _prepare_split_single
    writer.write_table(table)
  File "/home/gilyoav/miniconda3/lib/python3.12/site-packages/datasets/arrow_writer.py", line 590, in write_table
    self.pa_writer.write_table(pa_table, writer_batch_size)
  File "pyarrow/ipc.pxi", line 529, in pyarrow.lib._CRecordBatchWriter.write_table
  File "pyarrow/error.pxi", line 88, in pyarrow.lib.check_status
  File "/home/gilyoav/miniconda3/lib/python3.12/site-packages/fsspec/implementations/local.py", line 389, in write
    return self.f.write(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 28] No space left on device

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/gilyoav/miniconda3/lib/python3.12/site-packages/datasets/builder.py", line 2027, in _prepare_split_single
    num_examples, num_bytes = writer.finalize()
                              ^^^^^^^^^^^^^^^^^
  File "/home/gilyoav/miniconda3/lib/python3.12/site-packages/datasets/arrow_writer.py", line 607, in finalize
    self.stream.close()
  File "/home/gilyoav/miniconda3/lib/python3.12/site-packages/fsspec/implementations/local.py", line 407, in close
    return self.f.close()
           ^^^^^^^^^^^^^^
OSError: [Errno 28] No space left on device

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/gilyoav/Haptic-PBR-Maps/PBR_Modules/test11.py", line 9, in <module>
    dataset = load_dataset('parquet', data_files={'train': train_files, 'test': test_files})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gilyoav/miniconda3/lib/python3.12/site-packages/datasets/load.py", line 2609, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/gilyoav/miniconda3/lib/python3.12/site-packages/datasets/builder.py", line 1027, in download_and_prepare
    self._download_and_prepare(
  File "/home/gilyoav/miniconda3/lib/python3.12/site-packages/datasets/builder.py", line 1122, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/gilyoav/miniconda3/lib/python3.12/site-packages/datasets/builder.py", line 1882, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/gilyoav/miniconda3/lib/python3.12/site-packages/datasets/builder.py", line 2038, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset


# item processing function
def process_batch(examples):
	for key in ["basecolor", "normal", "metallic", "roughness"]:
		examples[key] = [process_img(x) for x in examples[key]]
	return examples